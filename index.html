<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Viral+ Pop+ UX</title>
<style>
*{box-sizing:border-box}
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:Arial,sans-serif;
  overflow:hidden;
}

/* HEADER */
header{
  position:fixed;
  top:0;
  width:100%;
  z-index:10;
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:12px;
  background:rgba(0,0,0,0.8);
}
header strong{font-size:20px; margin-bottom:6px;}
#popBarContainer{
  width:90%;
  max-width:400px;
  display:flex;
  align-items:center;
  gap:10px;
}
.battery{
  flex:1;
  height:16px;
  border:2px solid #22d3ee;
  border-radius:10px;
  overflow:hidden;
  position:relative;
}
.energy{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#22d3ee,#3b82f6);
  transition:width 0.3s;
}
#popPercent{
  min-width:40px;
  text-align:right;
  font-weight:bold;
}

/* FEED */
#feed{
  height:100vh;
  overflow-y:scroll;
  scroll-snap-type:y mandatory;
}
.post{
  height:100vh;
  scroll-snap-align:start;
  position:relative;
}
.post video,.post img{
  width:100%;
  height:100%;
  object-fit:cover;
}

/* OVERLAY */
.overlay{
  position:absolute;
  bottom:90px;
  left:12px;
  right:80px;
}
.overlay .author{font-weight:bold; font-size:16px;}
.overlay .text{margin-top:6px; font-size:14px;}

/* ACTIONS */
.actions{
  position:absolute;
  right:12px;
  bottom:120px;
  display:flex;
  flex-direction:column;
  gap:12px;
}
.actions button{
  width:48px;
  height:48px;
  border-radius:50%;
  border:none;
  background:rgba(0,0,0,0.5);
  color:#fff;
  font-size:18px;
  cursor:pointer;
  display:flex;
  justify-content:center;
  align-items:center;
  position:relative;
}
.actions button span{
  position:absolute;
  top:-20px;
  font-size:12px;
  color:#fff;
}

/* GRAPH */
#graphContainer{
  position:fixed;
  bottom:12px;
  left:50%;
  transform:translateX(-50%);
  width:90%;
  max-width:400px;
}
canvas{
  width:100%;
  height:150px;
  background:#020617;
  border-radius:8px;
}
.legend{
  display:flex;
  justify-content:space-between;
  font-size:12px;
  margin-top:4px;
}
.legend div{display:flex; align-items:center; gap:4px;}
.legend span{display:inline-block;width:12px;height:12px;border-radius:50%;}
</style>
</head>
<body>

<header>
  <strong>Viral+</strong>
  <div id="popBarContainer">
    <div class="battery"><div class="energy" id="energy"></div></div>
    <div id="popPercent">0%</div>
  </div>
</header>

<div id="feed"></div>

<div id="graphContainer">
  <canvas id="graph"></canvas>
  <div class="legend">
    <div><span style="background:#22d3ee"></span> Likes</div>
    <div><span style="background:#f87171"></span> Dislikes</div>
    <div><span style="background:#a3e635"></span> Commentaires</div>
  </div>
</div>

<script>
// ------------------
// POSTS MOCK
// ------------------
const posts = [
  {author:"anonyme", text:"Bienvenue sur Viral+", media:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4", type:"video", likes:2, dislikes:0, comments:1},
  {author:"kody", text:"Scroll fluide comme TikTok", media:"https://picsum.photos/1080/1920?1", type:"image", likes:5, dislikes:1, comments:2},
  {author:"user47", text:"Ta marque : barre + 3 courbes", media:"https://picsum.photos/1080/1920?2", type:"image", likes:1, dislikes:0, comments:0}
];

// ------------------
// FEED
// ------------------
const feed=document.getElementById("feed");

posts.forEach((p)=>{
  const post=document.createElement("div");
  post.className="post";

  let media;
  if(p.type==="video"){
    media=document.createElement("video");
    media.src=p.media;
    media.autoplay=true;
    media.loop=true;
    media.muted=true;
  }else{
    media=document.createElement("img");
    media.src=p.media;
  }
  post.appendChild(media);

  const overlay=document.createElement("div");
  overlay.className="overlay";
  overlay.innerHTML=`<div class="author">@${p.author}</div><div class="text">${p.text}</div>`;
  post.appendChild(overlay);

  const actions=document.createElement("div");
  actions.className="actions";

  // J'aime
  const like=document.createElement("button");
  like.innerHTML="â¤ï¸";
  const likeCount=document.createElement("span");
  likeCount.innerText=p.likes;
  like.appendChild(likeCount);
  like.onclick=()=>{
    p.likes++;
    likeCount.innerText=p.likes;
    updatePopularity();
  };
  actions.appendChild(like);

  // J'aime pas
  const dislike=document.createElement("button");
  dislike.innerHTML="ðŸ’”";
  const dislikeCount=document.createElement("span");
  dislikeCount.innerText=p.dislikes;
  dislike.appendChild(dislikeCount);
  dislike.onclick=()=>{
    p.dislikes++;
    dislikeCount.innerText=p.dislikes;
    updatePopularity();
  };
  actions.appendChild(dislike);

  // Commentaires
  const comment=document.createElement("button");
  comment.innerHTML="ðŸ’¬";
  const commentCount=document.createElement("span");
  commentCount.innerText=p.comments;
  comment.appendChild(commentCount);
  comment.onclick=()=>{
    p.comments++;
    commentCount.innerText=p.comments;
    updatePopularity();
  };
  actions.appendChild(comment);

  post.appendChild(actions);
  feed.appendChild(post);
});

// ------------------
// POPULARITY & GRAPH
// ------------------
const energy=document.getElementById("energy");
const popPercent=document.getElementById("popPercent");
const ctx=document.getElementById("graph").getContext("2d");

let history={likes:[],dislikes:[],comments:[]};

function updatePopularity(){
  let totalLikes=0,totalDislikes=0,totalComments=0;
  posts.forEach(p=>{
    totalLikes+=p.likes;
    totalDislikes+=p.dislikes;
    totalComments+=p.comments;
  });

  // Score barre horizontale
  const score=Math.min(100,totalLikes*5 - totalDislikes*2 + totalComments*2);
  energy.style.width=score+"%";
  popPercent.innerText=Math.round(score)+"%";

  // Historique avec variations style bourse
  history.likes.push(totalLikes + Math.random()*3 - 1.5);
  history.dislikes.push(totalDislikes + Math.random()*2 - 1);
  history.comments.push(totalComments + Math.random()*2 - 1);

  if(history.likes.length>20){
    history.likes.shift();
    history.dislikes.shift();
    history.comments.shift();
  }

  drawGraph();
}

function drawGraph(){
  ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);

  drawLine(history.likes,"#22d3ee");
  drawLine(history.dislikes,"#f87171");
  drawLine(history.comments,"#a3e635");

  // RÃ¨gles
  ctx.strokeStyle="rgba(255,255,255,0.2)";
  ctx.lineWidth=1;
  const rows=5,cols=6;
  for(let i=0;i<=rows;i++){
    let y=i*(ctx.canvas.height/rows);
    ctx.beginPath();
    ctx.moveTo(0,y);
    ctx.lineTo(ctx.canvas.width,y);
    ctx.stroke();
  }
  for(let i=0;i<=cols;i++){
    let x=i*(ctx.canvas.width/cols);
    ctx.beginPath();
    ctx.moveTo(x,0);
    ctx.lineTo(x,ctx.canvas.height);
    ctx.stroke();
  }
}

function drawLine(data,color){
  ctx.beginPath();
  ctx.strokeStyle=color;
  ctx.lineWidth=2;
  data.forEach((v,i)=>{
    const x=i/(data.length-1||1)*ctx.canvas.width;
    const y=ctx.canvas.height - (v/20)*ctx.canvas.height;
    i?ctx.lineTo(x,y):ctx.moveTo(x,y);
  });
  ctx.stroke();
}

// Animation automatique style bourse
setInterval(()=>{
  // Chaque 0.5s on ajoute un lÃ©ger mouvement
  posts.forEach(p=>{
    p.likes += Math.random()*0.1;
    p.dislikes += Math.random()*0.05;
    p.comments += Math.random()*0.05;
  });
  updatePopularity();
},500);

// Initialisation
updatePopularity();
</script>
</body>
  </html>
